---
title: "p8105_hw2_es3866"
output: github_document
date: 2024-09-27
---

```{r setup}
library(tidyverse)
library(dplyr)
```

##Problem 1:
# Use relative path to upload the datasets

```{r}
pols_df = read_csv(file = "./fivethirtyeight_datasets/pols-month.csv")
pols_df = janitor::clean_names(pols_df)
```

# Clean the data in pols-month.csv. 
Use separate() to break up the variable mon into integer variables year, month, and day.

```{r}
pols_df <- pols_df %>%
  separate(mon, c("year", "month", "day"))
```

Replace month number with month name. 
```{r}
pols_df <- pols_df %>%
  mutate(
    month = as.integer(.data$month),
    month = month.name[month]) %>%
  mutate(year = as.integer(year))
```

Create a president variable taking values gop and dem. The pivot function automatically gets rid of prez_gop and prez_dem.

```{r}
pols_df <- pols_df %>%
    pivot_longer(
      cols = c(prez_gop, prez_dem),
      names_to = "president",
      values_to = "party"
  )
```

Remove the day variable.

```{r}
pols_df <- pols_df %>%
  select(-day)
```

# Clean the data in snp.csv

```{r}

snp_df = read_csv(file = "./fivethirtyeight_datasets/snp.csv")
snp_df = janitor::clean_names(snp_df)
```

Break up the data variables into day, month, and year

```{r}
snp_df <- snp_df %>%
  separate(date, c("month", "day", "year"))
```

For consistency across datasets, arrange according to year and month, and organize so that year and month are the leading columns.

```{r}
snp_df <- snp_df %>%  
  mutate(
    year = as.integer(year),
    year = ifelse(year < 40, 2000 + year, 1900 + year)) %>%
  mutate(
    month = as.integer(month),
    month = month.name[month]) %>%
  select(year, month, everything())
```


Tidy the unemployment data so that it can be merged with the previous datasets. This process will involve switching from “wide” to “long” format; ensuring that key variables have the same name; and ensuring that key variables take the same values.

```{r}
unemployment_df = read_csv(file = "./fivethirtyeight_datasets/unemployment.csv")
unemployment_df = janitor::clean_names(unemployment_df)
```

```{r}
unemployment_df <- unemployment_df %>%
  pivot_longer(
    cols = jan:dec,
    names_to = "month",
    values_to = "percentage"
  )
```

```{r}
unemployment_df <- unemployment_df %>%
  mutate(month = month.name[match(tolower(month), tolower(month.abb))])
```

```{r}
unemployment_df <- unemployment_df %>%
  mutate(
    year = as.integer(year)
  )
```

Now, merge the data sets!
Join the datasets by merging snp into pols, and merging unemployment into the result.

```{r}
snp_pols_df <- snp_df %>%
  left_join(pols_df, by = c("year", "month"))
```

```{r}
merged_df <- snp_pols_df %>%
  left_join(unemployment_df, by = c("year", "month"))
```

# Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

The file “pols-month” contains 822 observations related to the number of national politicians who are democratic or republican (senators, representatives, govenors, president) at any given time.
The snp dataset contains 787 observations related to the S&P including the date and the closing values of the S&P stock index on the associated date.
The unemployment dataset contains 68 observations including the year and the percentage of unemployment in the month of the associated year.

The merged dataset contains data from the years 1950-2015 and aligns the political state (republican vs democrat) at a given time to the S&P index closing values and unemployment data. It appears that the unemplyment rates increase when there is a republican president. Overall, S&P performance has increased over time.



## Problem 2:

```{r}
library(readxl) 
mr_trash <- read_excel("./202409 Trash Wheel Collection Data.xlsx",
                       sheet = 1)  %>%
                       slice(1:(n() - 1)) %>%
  mutate(wheel = "mr_trash",
         Year = as.integer(Year))

professor_trash <- read_excel("./202409 Trash Wheel Collection Data.xlsx",
                              sheet = 2)  %>%
                              slice(1:(n() - 1)) %>%
  mutate(wheel = "professor_trash",
         Year = as.integer(Year))

gwynnda_trash <- read_excel("./202409 Trash Wheel Collection Data.xlsx",
                            sheet = 4)  %>%
                            slice(1:(n() - 1)) %>%
  mutate(wheel = "gwynnda_trash",
         Year = as.integer(Year))

# Combine them into one tidy dataset
trashwheel_df <- bind_rows(mr_trash, professor_trash, gwynnda_trash)

trashwheel_df = janitor::clean_names(trashwheel_df)
```

# Write a paragraph about these data
Be sure to note the number of observations in the resulting dataset, and give examples of key variables. For available data, what was the total weight of trash collected by Professor Trash Wheel? What was the total number of cigarette butts collected by Gwynnda in June of 2022?


```{r}
trashwheel_df %>%
  group_by(wheel) %>%
  summarise(n_obs = n())
```

```{r}
trashwheel_df %>%
  select(dumpster, month, year, weight_tons, cigarette_butts, wheel)
```

How many tons did each wheel collect? Mr. Trash, it collected 2091.18 tons of trash.
```{r}
trashwheel_df %>%
  group_by(wheel) %>%
  summarise(total_weight = sum(weight_tons, na.rm = TRUE))
```

How many cigarette butts did gwynnda collect in June 2022? 18120
```{r}
trashwheel_df %>%
  filter(wheel == "gwynnda_trash", year == 2022, month == "June") %>%
  summarise(total_cigs = sum(cigarette_butts, na.rm = TRUE))
```


## Problem 3
